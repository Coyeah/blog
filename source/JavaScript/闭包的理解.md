| 题目       | 创建时间            | 标签            |
| :--------- | :------------------ | :-------------- |
| 闭包的理解 | 2018-04-13 17:13:53 | JavaScript/前端 |

------

对于JavaScript的闭包：说理解嘛，知道它在说什么怎么用；说不理解嘛，我还真不知道它用在哪？

> 本质上无论何时何地，如果将（访问它们各自词法作用域的）函数作为第一级的值类型并到处传递，你就会看到闭包在这些函数中的应用。在定时器、事件监听器、AJAX请求、跨窗口同性、Web Workers或者任何其他的异步（或者同步）任务中，只要使用了回调函数，实际上就是在使用闭包！ ——————『你不知道的JavaScript』

对于闭包的解读，引用[Ahonn](https://github.com/ahonn)的解释。

> 就是 A 函数返回 B 函数，B 函数能够访问 A 函数中的局部变量，使得在 A 外部的作用域中能够使用 B 函数间接操作 A 函数中的局部变量，这样就形成了一个闭包。A 函数中的局部变量与返回的 B 函数一同存在，不会被垃圾回收机制清理（引用还存在）。

看了这两段，好吧，闭包，我知道怎么写，我知道是什么作用。emmm，总感觉缺了点什么。恰恰在[How do JavaScript closures work?](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)中找到了个很好的解释。可能我还是小孩子吧。

> **从前：**
> 有一位公主......
> 
```JavaScript
function princess() {
```
> 
> 她生活在一个充满奇幻冒险的世界里, 她遇到了她的白马王子, 带着他骑着独角兽开始周游这个世界，与巨龙战斗，巧遇会说话的动物，还有其他一些新奇的事物。
> 
```JavaScript
var adventures = [];
function princeCharming() { ... }  //白马王子
var uicorn = { ... },               //独角兽
    dragon = { ... },               //龙
    squirrel = "Hello";             //松鼠
```
> 
> 但是她不得不回到她的王国里，面对那些年老的大臣。
> 
```JavaScript
return {
```
> 
> 她会经常给那些大臣们分享她作为公主最近在外面充满奇幻的冒险经历。
> 
```JavaScript
  story: function() {
    return adventures[adventures.length - 1];
  }
  };
}
```
> 即便所有大臣们知道他们眼前的小女孩是真的公主，但是他们却不会相信有巨龙或独角兽，因为他们自己从来没有见到过。大臣们只会觉得它们只存在于小女孩的想象之中。
> 
> 但是我们却知道小女孩述说的是事实......

**论编程抽象能力的重要性**，*If you can't explain it to a six-year-old, you really don't understand it yourself.*