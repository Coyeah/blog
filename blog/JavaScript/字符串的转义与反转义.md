| 题目                 | 创建时间            | 标签       |
| -------------------- | ------------------- | ---------- |
| 字符串的转义与反转义 | 2018-05-25 19:47:24 | JavaScript |

------

## 转义与反转义

在WEB输入的情况下，如果没有转义的设置。大的会导致XSS攻击，小的会改变整个样式或者其他未知的错误。

例如输入&lt;b&gt;，你会发现你输入的内容变成加粗。用&amp;lt;和&amp;gt;替换掉，就要靠JS完成了。

第一种方法：

```JavaScript
function html_encode(str) { 
  var s = ""; 
  if (str.length == 0) return ""; 
  s = str.replace(/&/g, "&gt;"); 
  s = s.replace(/</g, "&lt;"); 
  s = s.replace(/>/g, "&gt;"); 
  s = s.replace(/ /g, "&nbsp;"); 
  s = s.replace(/\'/g, "&#39;"); 
  s = s.replace(/\"/g, "&quot;"); 
  s = s.replace(/\n/g, "<br>"); 
  return s; 
}

function html_decode(str) { 
  var s = ""; 
  if (str.length == 0) return ""; 
  s = str.replace(/&gt;/g, "&"); 
  s = s.replace(/&lt;/g, "<"); 
  s = s.replace(/&gt;/g, ">"); 
  s = s.replace(/&nbsp;/g, " "); 
  s = s.replace(/&#39;/g, "\'"); 
  s = s.replace(/&quot;/g, "\""); 
  s = s.replace(/<br>/g, "\n"); 
  return s; 
}
```

第二种方法：

```JavaScript
function htmlEncode(str) {
  var div = document.createElement("div");
  div.appendChild(document.createTextNode(str));
  return div.innerHTML;
}

function htmlDecode(str) {
  var div = document.createElement("div");
  div.innerHTML = str;
  return div.innerHTML;
}
```